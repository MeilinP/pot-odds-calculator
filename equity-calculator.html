<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Texas Hold'em Equity Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 20px;
            color: white;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 36px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .calculator-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .player-section {
            background: rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .player-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 15px;
            color: #4facfe;
        }

        .hand-input-group {
            margin-bottom: 15px;
        }

        .hand-input-label {
            display: block;
            font-size: 14px;
            margin-bottom: 8px;
            color: rgba(255, 255, 255, 0.9);
        }

        .card-inputs {
            display: flex;
            gap: 10px;
        }

        .card-select {
            flex: 1;
            padding: 12px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.15);
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
        }

        .card-select option {
            background: #1e3c72;
            color: white;
        }

        .board-section {
            background: rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            margin-bottom: 20px;
        }

        .board-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 15px;
            color: #f093fb;
        }

        .board-cards {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .board-card-group {
            flex: 1;
            min-width: 150px;
        }

        .calculate-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 20px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 20px;
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .calculate-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .results-section {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            display: none;
        }

        .results-section.show {
            display: block;
        }

        .equity-bars {
            margin-bottom: 30px;
        }

        .equity-bar {
            margin-bottom: 20px;
        }

        .equity-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 16px;
        }

        .equity-bar-bg {
            width: 100%;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            overflow: hidden;
            position: relative;
        }

        .equity-bar-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 18px;
            transition: width 0.5s ease;
        }

        .equity-bar-fill.player1 {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .equity-bar-fill.player2 {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .equity-bar-fill.tie {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-label {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #fff;
        }

        .info-box {
            background: rgba(102, 126, 234, 0.2);
            border: 2px solid rgba(102, 126, 234, 0.5);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            font-size: 14px;
            line-height: 1.6;
        }

        .error-message {
            background: rgba(220, 53, 69, 0.2);
            border: 2px solid rgba(220, 53, 69, 0.5);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        @media (max-width: 768px) {
            .calculator-grid {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸŽ² Equity Calculator</h1>

        <div class="error-message" id="errorMessage"></div>

        <div class="calculator-grid">
            <div class="player-section">
                <div class="player-title">Your Hand</div>
                <div class="hand-input-group">
                    <label class="hand-input-label">Card 1</label>
                    <div class="card-inputs">
                        <select class="card-select" id="p1card1">
                            <option value="">-</option>
                        </select>
                    </div>
                </div>
                <div class="hand-input-group">
                    <label class="hand-input-label">Card 2</label>
                    <div class="card-inputs">
                        <select class="card-select" id="p1card2">
                            <option value="">-</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="player-section">
                <div class="player-title">Opponent's Hand</div>
                <div class="hand-input-group">
                    <label class="hand-input-label">Card 1</label>
                    <div class="card-inputs">
                        <select class="card-select" id="p2card1">
                            <option value="">-</option>
                        </select>
                    </div>
                </div>
                <div class="hand-input-group">
                    <label class="hand-input-label">Card 2</label>
                    <div class="card-inputs">
                        <select class="card-select" id="p2card2">
                            <option value="">-</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <div class="board-section">
            <div class="board-title">Community Cards (Optional)</div>
            <div class="board-cards">
                <div class="board-card-group">
                    <label class="hand-input-label">Flop 1</label>
                    <select class="card-select" id="flop1">
                        <option value="">-</option>
                    </select>
                </div>
                <div class="board-card-group">
                    <label class="hand-input-label">Flop 2</label>
                    <select class="card-select" id="flop2">
                        <option value="">-</option>
                    </select>
                </div>
                <div class="board-card-group">
                    <label class="hand-input-label">Flop 3</label>
                    <select class="card-select" id="flop3">
                        <option value="">-</option>
                    </select>
                </div>
                <div class="board-card-group">
                    <label class="hand-input-label">Turn</label>
                    <select class="card-select" id="turn">
                        <option value="">-</option>
                    </select>
                </div>
                <div class="board-card-group">
                    <label class="hand-input-label">River</label>
                    <select class="card-select" id="river">
                        <option value="">-</option>
                    </select>
                </div>
            </div>
        </div>

        <button class="calculate-btn" id="calculateBtn" onclick="calculateEquity()">
            Calculate Equity
        </button>

        <div class="results-section" id="resultsSection">
            <div class="equity-bars">
                <div class="equity-bar">
                    <div class="equity-label">
                        <span>Your Hand Wins</span>
                        <span id="p1EquityPercent">0%</span>
                    </div>
                    <div class="equity-bar-bg">
                        <div class="equity-bar-fill player1" id="p1EquityBar" style="width: 0%">
                            <span id="p1EquityText">0%</span>
                        </div>
                    </div>
                </div>

                <div class="equity-bar">
                    <div class="equity-label">
                        <span>Opponent Wins</span>
                        <span id="p2EquityPercent">0%</span>
                    </div>
                    <div class="equity-bar-bg">
                        <div class="equity-bar-fill player2" id="p2EquityBar" style="width: 0%">
                            <span id="p2EquityText">0%</span>
                        </div>
                    </div>
                </div>

                <div class="equity-bar">
                    <div class="equity-label">
                        <span>Tie</span>
                        <span id="tieEquityPercent">0%</span>
                    </div>
                    <div class="equity-bar-bg">
                        <div class="equity-bar-fill tie" id="tieEquityBar" style="width: 0%">
                            <span id="tieEquityText">0%</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Simulations</div>
                    <div class="stat-value" id="simulations">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Your Wins</div>
                    <div class="stat-value" id="p1Wins">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Opp Wins</div>
                    <div class="stat-value" id="p2Wins">0</div>
                </div>
            </div>

            <div class="info-box">
                <strong>ðŸ’¡ What is Equity?</strong><br>
                Equity is the percentage chance your hand will win by the river. This calculator runs thousands of simulations to determine your winning probability.
            </div>
        </div>
    </div>

    <script>
        // Card deck
        const ranks = ['A', 'K', 'Q', 'J', 'T', '9', '8', '7', '6', '5', '4', '3', '2'];
        const suits = ['â™ ', 'â™¥', 'â™¦', 'â™£'];
        const suitSymbols = ['s', 'h', 'd', 'c'];
        
        let allCards = [];
        
        // Generate all 52 cards
        ranks.forEach(rank => {
            suits.forEach((suit, idx) => {
                allCards.push(rank + suit);
            });
        });

        // Populate all select dropdowns
        function populateCardSelects() {
            const selects = document.querySelectorAll('.card-select');
            selects.forEach(select => {
                allCards.forEach(card => {
                    const option = document.createElement('option');
                    option.value = card;
                    option.textContent = card;
                    select.appendChild(option);
                });
            });
        }

        // Get selected cards
        function getSelectedCards() {
            const cards = {
                p1: [
                    document.getElementById('p1card1').value,
                    document.getElementById('p1card2').value
                ],
                p2: [
                    document.getElementById('p2card1').value,
                    document.getElementById('p2card2').value
                ],
                board: [
                    document.getElementById('flop1').value,
                    document.getElementById('flop2').value,
                    document.getElementById('flop3').value,
                    document.getElementById('turn').value,
                    document.getElementById('river').value
                ].filter(card => card !== '')
            };
            return cards;
        }

        // Validate no duplicate cards
        function validateCards(cards) {
            const allSelected = [...cards.p1, ...cards.p2, ...cards.board].filter(c => c !== '');
            const uniqueCards = new Set(allSelected);
            
            if (allSelected.length !== uniqueCards.size) {
                return { valid: false, error: 'Duplicate cards detected! Each card can only be used once.' };
            }
            
            if (cards.p1.some(c => c === '')) {
                return { valid: false, error: 'Please select both cards for your hand.' };
            }
            
            if (cards.p2.some(c => c === '')) {
                return { valid: false, error: 'Please select both cards for opponent\'s hand.' };
            }
            
            return { valid: true };
        }

        // Show error message
        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.classList.add('show');
            setTimeout(() => {
                errorDiv.classList.remove('show');
            }, 4000);
        }

        // Card value for comparison
        function getCardValue(card) {
            const rank = card[0];
            const values = { 'A': 14, 'K': 13, 'Q': 12, 'J': 11, 'T': 10 };
            return values[rank] || parseInt(rank);
        }

        // Card suit
        function getCardSuit(card) {
            return card[1];
        }

        // Evaluate poker hand (simplified - returns hand strength score)
        function evaluateHand(hand) {
            // This is a simplified evaluation
            // In production, you'd use a proper hand evaluator
            const values = hand.map(getCardValue).sort((a, b) => b - a);
            const suits = hand.map(getCardSuit);
            
            // Count frequencies
            const valueFreq = {};
            values.forEach(v => valueFreq[v] = (valueFreq[v] || 0) + 1);
            const freqs = Object.values(valueFreq).sort((a, b) => b - a);
            
            // Check flush
            const isFlush = suits.every(s => s === suits[0]);
            
            // Check straight
            let isStraight = false;
            if (values.length >= 5) {
                const uniqueValues = [...new Set(values)].sort((a, b) => b - a);
                for (let i = 0; i <= uniqueValues.length - 5; i++) {
                    if (uniqueValues[i] - uniqueValues[i + 4] === 4) {
                        isStraight = true;
                        break;
                    }
                }
                // Check wheel (A-2-3-4-5)
                if (uniqueValues.includes(14) && uniqueValues.includes(5) && 
                    uniqueValues.includes(4) && uniqueValues.includes(3) && uniqueValues.includes(2)) {
                    isStraight = true;
                }
            }
            
            // Hand ranking (higher is better)
            if (isStraight && isFlush) return 8000000 + Math.max(...values); // Straight flush
            if (freqs[0] === 4) return 7000000 + values[0]; // Four of a kind
            if (freqs[0] === 3 && freqs[1] === 2) return 6000000 + values[0]; // Full house
            if (isFlush) return 5000000 + Math.max(...values); // Flush
            if (isStraight) return 4000000 + Math.max(...values); // Straight
            if (freqs[0] === 3) return 3000000 + values[0]; // Three of a kind
            if (freqs[0] === 2 && freqs[1] === 2) return 2000000 + values[0] * 100 + values[1]; // Two pair
            if (freqs[0] === 2) return 1000000 + values[0]; // Pair
            return Math.max(...values) * 10000 + values[1] * 100 + values[2]; // High card
        }

        // Get best 5-card hand from 7 cards
        function getBestHand(sevenCards) {
            let bestScore = 0;
            // Try all combinations of 5 cards from 7
            for (let i = 0; i < sevenCards.length - 4; i++) {
                for (let j = i + 1; j < sevenCards.length - 3; j++) {
                    for (let k = j + 1; k < sevenCards.length - 2; k++) {
                        for (let l = k + 1; l < sevenCards.length - 1; l++) {
                            for (let m = l + 1; m < sevenCards.length; m++) {
                                const hand = [sevenCards[i], sevenCards[j], sevenCards[k], sevenCards[l], sevenCards[m]];
                                const score = evaluateHand(hand);
                                if (score > bestScore) bestScore = score;
                            }
                        }
                    }
                }
            }
            return bestScore;
        }

        // Run Monte Carlo simulation
        function runSimulation(p1Hand, p2Hand, board, numSimulations = 10000) {
            let p1Wins = 0;
            let p2Wins = 0;
            let ties = 0;
            
            const usedCards = new Set([...p1Hand, ...p2Hand, ...board]);
            const deck = allCards.filter(card => !usedCards.has(card));
            
            const cardsNeeded = 5 - board.length;
            
            for (let i = 0; i < numSimulations; i++) {
                // Shuffle deck
                const shuffled = [...deck].sort(() => Math.random() - 0.5);
                
                // Draw remaining board cards
                const fullBoard = [...board, ...shuffled.slice(0, cardsNeeded)];
                
                // Evaluate both hands
                const p1SevenCards = [...p1Hand, ...fullBoard];
                const p2SevenCards = [...p2Hand, ...fullBoard];
                
                const p1Score = getBestHand(p1SevenCards);
                const p2Score = getBestHand(p2SevenCards);
                
                if (p1Score > p2Score) {
                    p1Wins++;
                } else if (p2Score > p1Score) {
                    p2Wins++;
                } else {
                    ties++;
                }
            }
            
            return {
                p1Wins,
                p2Wins,
                ties,
                total: numSimulations,
                p1Equity: (p1Wins / numSimulations * 100).toFixed(1),
                p2Equity: (p2Wins / numSimulations * 100).toFixed(1),
                tieEquity: (ties / numSimulations * 100).toFixed(1)
            };
        }

        // Calculate and display equity
        function calculateEquity() {
            const cards = getSelectedCards();
            const validation = validateCards(cards);
            
            if (!validation.valid) {
                showError(validation.error);
                return;
            }
            
            // Show calculating state
            const btn = document.getElementById('calculateBtn');
            btn.textContent = 'Calculating...';
            btn.disabled = true;
            
            // Run simulation in setTimeout to allow UI to update
            setTimeout(() => {
                const results = runSimulation(cards.p1, cards.p2, cards.board);
                
                // Update UI
                document.getElementById('p1EquityPercent').textContent = results.p1Equity + '%';
                document.getElementById('p2EquityPercent').textContent = results.p2Equity + '%';
                document.getElementById('tieEquityPercent').textContent = results.tieEquity + '%';
                
                document.getElementById('p1EquityBar').style.width = results.p1Equity + '%';
                document.getElementById('p2EquityBar').style.width = results.p2Equity + '%';
                document.getElementById('tieEquityBar').style.width = results.tieEquity + '%';
                
                document.getElementById('p1EquityText').textContent = results.p1Equity + '%';
                document.getElementById('p2EquityText').textContent = results.p2Equity + '%';
                document.getElementById('tieEquityText').textContent = results.tieEquity + '%';
                
                document.getElementById('simulations').textContent = results.total.toLocaleString();
                document.getElementById('p1Wins').textContent = results.p1Wins.toLocaleString();
                document.getElementById('p2Wins').textContent = results.p2Wins.toLocaleString();
                
                // Show results
                document.getElementById('resultsSection').classList.add('show');
                
                // Reset button
                btn.textContent = 'Calculate Equity';
                btn.disabled = false;
                
                // Scroll to results
                document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth' });
            }, 100);
        }

        // Initialize
        populateCardSelects();
    </script>
</body>
</html>
